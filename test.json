{
    "query": "\n  query Aggregations(\n    $input: IndexesInput!\n    $filter: FilterBuzzInput\n    $aggs: [AggregationTypeInput]!\n  ) {\n    aggregations(input: $input, filter: $filter, aggs: $aggs) {\n      status\n      message\n      data\n    }\n  }\n",
    "variables": {
      "input": {
        "indexes": [
          "5683bd53f9876f7e0db58a7b"
        ]
      },
      "filter": {
        "publishedFromDate": "{{ $('Trigger').item.json.body.start_date }}",
        "publishedToDate": "{{ $('Trigger').item.json.body.end_date }}",
        "types": [
          "FBPAGE_TOPIC",
          "FBPAGE_COMMENT",
          "FBGROUP_TOPIC",
          "FBGROUP_COMMENT",
          "FBUSER_TOPIC",
          "FBUSER_COMMENT",
          "FORUM_TOPIC",
          "FORUM_COMMENT",
          "NEWS_TOPIC",
          "NEWS_COMMENT",
          "YOUTUBE_TOPIC",
          "YOUTUBE_COMMENT",
          "BLOG_TOPIC",
          "BLOG_COMMENT",
          "QA_TOPIC",
          "QA_COMMENT",
          "SNS_TOPIC",
          "SNS_COMMENT",
          "TIKTOK_TOPIC",
          "TIKTOK_COMMENT",
          "LINKEDIN_TOPIC",
          "LINKEDIN_COMMENT",
          "ECOMMERCE_TOPIC",
          "ECOMMERCE_COMMENT",
          "THREADS_TOPIC",
          "THREADS_COMMENT"
        ],
        "isDeleted": false,
        "sentiments": [
          "NONE",
          "POSITIVE",
          "NEGATIVE",
          "NEUTRAL"
        ],
        "labels": [{{ $('Trigger').item.json.body.label_ids }}],
        "levels": [
          "NONE",
          "LEVEL_1",
          "LEVEL_2",
          "LEVEL_3"
        ]
      },
      "aggs": [
        {
          "type": "DATE_HISTOGRAM",
          "field": "PUBLISHED_DATE",
          "extendName": "TRENDLINE",
          "option": {
            "date_histogram": {
              "calendar_interval": "DAY",
              "time_zone": "+07:00",
              "min_doc_count": 0,
              "extended_bounds": {
                "min": "{{ $('Trigger').item.json.body.start_date }}",
                "max": "{{ $('Trigger').item.json.body.end_date }}"
              }
            }
          },
          "nest": [
            {
              "type": "TERMS",
              "field": "SENTIMENT"
            }
          ]
        },
        {
          "type": "VALUE_COUNT",
          "extendName": "TOTAL",
          "field": "TYPE"
        },
        {
          "field": "PARENT_ID",
          "type": "TERMS",
          "extendName": "HOT_TOPICS",
          "option": {
            "terms": {
              "size": 10,
              "order": {
                "_count": "DESC"
              }
            }
          },
          "nest": [
            {
              "field": "INTERACTIONS",
              "type": "TOP_HITS",
              "option": {
                "top_hits": {
                  "size": 1,
                  "sort": "DESC",
                  "_source": {
                    "includes": [
                      "TITLE",
                      "SENTIMENT",
                      "PROFILE_NAME",
                      "PROFILE_ID",
                      "CONTENT",
                      "CONTENT_TYPE",
                      "PUBLISHED_DATE",
                      "TYPE",
                      "SITE_NAME",
                      "SITE_ID"
                    ]
                  }
                }
              }
            },
            {
              "type": "TERMS",
              "field": "SENTIMENT"
            }
          ]
        }
      ]
    },
    "operationName": "Aggregations"
  } 